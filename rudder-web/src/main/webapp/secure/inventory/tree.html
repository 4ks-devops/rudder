<lift:surround with="menu/menu-asset" at="content">
<div class="portlet">
  <div class="portlet-header">Inventory as a tree</div>
  <div class="portlet-content">
  
  <head>
  <style type="text/css">
    .tree li.filteredNode { display:none; }
  </style>
  <script type="text/javascript">
  //<![CDATA[
    jQuery.extend(jQuery.expr[":"], {  
      "notContainsCI": function(elem, i, match, array) {  
        return (elem.textContent || elem.innerText || "").toLowerCase().indexOf((match[3] || "").toLowerCase()) < 0;  
       }  
    }); 
    
    var filterLi = function(filter) {
          jQuery(".filteredNode").removeClass("filteredNode");
          if( jQuery.tree && jQuery.tree.focused() && jQuery.tree.focused().selected ) {
            jQuery.tree.focused().selected.each( function(i) {    
              jQuery(this).find("li:notContainsCI("+filter+")").addClass("filteredNode");
            });
          }
    }
    
    jQuery(document).ready(function() {
      var filterTimer;
	    jQuery("#filterNode").keyup(function(event) {
	      var filter = jQuery(this).val();
        clearTimeout(filterTimer);
        if(event.keyCode == 13) { 
          filterLi(filter); 
        } else {
          filterTimer = setTimeout(function() {
            filterLi(filter);
          }, 1000);
        }
	    });
    }); 
  //]]>
  </script>  
  </head>
  
  <div id="middle">
    <h3>Parcours de l'arbre</h3>
    
    <p>Selectionnez un noeud puis filter ses enfants:</p>
    <input id="filterNode" type="text"/><span style=" cursor:pointer;cursor:hand" 
      onclick="jQuery('#filterNode').each(function(i) { this.value =''; });filterLi('')">[clear]</span>
    <lift:LdapTree>
      <tree:head/>
      <div id="tree">
        <ul></ul>
      </div>
    </lift:LdapTree>
  </div>

  <div id="right3">
    <h3>Details</h3>
    <div class="articles" id="node_details">
      Click on an element on the left to display details
    </div>
  </div>
  
  </div>
</div>
</lift:surround>


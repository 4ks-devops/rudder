# SPDX-License-Identifier: CC-BY-SA-2.0
# SPDX-FileCopyrightText: 2013-2020 Normation SAS
type: object
properties:
  id:
    type: string
    format: uuid
    description: Group id
    default: "{autogenerated}"
    example: 32d013f7-b6d8-46c8-99d3-016307fa66c0
  displayName:
    type: string
    description: Name of the group
    example: "Ubuntu 18.04 nodes"
  description:
    type: string
    description: Group description
    example: "Documentation for the group"
  query:
    type: object
    description: The criteria defining the group
    properties:
      select:
        description: What kind of data we want to include. Here we can get policy servers/relay by setting `nodeAndPolicyServer`. Only used if `where` is defined.
        type: string
        default: node
      composition:
        type: string
        enum:
          - and
          - or
        default: and
        description: Boolean operator to use between each  `where` criteria.
        example: and
      where:
        type: array
        description: List of criteria
        items:
          type: object
          properties:
            objectType:
              type: string
              description: Type of the object
              example: node
            attribute:
              description: Attribute to compare
              example: OS
              type: string
            comparator:
              description: Comparator to use
              example: eq
              # FIXME enum
              type: string
            value:
              type: string
              example: Linux
              description: Value to compare against
  nodeIds:
    type: array
    description: List of nodes in the group
    items:
      type: string
      format: uuid (or "root")
      example: 109142a2-40eb-4e6d-84b4-7ebe3670474c
      description: Node in the group
  dynamic:
    type: boolean
    default: true
    description: Should the group be dynamically refreshed (if not, it is a static group)
  enabled:
    type: boolean
    default: true
    description: Enable or disable the group
  groupClass:
    type: array
    items:
      type: string
      format: condition
      example: "group_ubuntu"
      description: Conditions defined on nodes in the groups. There is one based on the group id, and one based on the group name.
  properties:
    type: array
    description: Group properties
    items:
      type: object
      required:
        - name
        - value
      properties:
        name:
          type: string
          description: Property name
          example: os
        value:
          format: string or JSON
          example: debian10
          description: Property value (can be a string or JSON object)